<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>üìà Revenue Analytics</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            margin-top: 60px;
        }
        .card {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .top-bar a {
            background-color: #6c757d;
            color: white;
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 6px;
        }
        .top-bar select {
            padding: 6px 12px;
            border-radius: 6px;
            margin-right: 10px;
        }
        .top-bar form {
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="card p-4">

        <!--  Back button and filter controls -->
        <div class="top-bar">
            <a href="/admin">‚Üê Back to Dashboard</a>

            <form method="get" action="/admin/revenue-chart">
                <label for="time">Time:</label>
                <select name="time" id="time" onchange="this.form.submit()">
                    <option value="all" th:selected="${selectedTime == 'all'}">All Time</option>
                    <option value="month" th:selected="${selectedTime == 'month'}">This Month</option>
                    <option value="week" th:selected="${selectedTime == 'week'}">This Week</option>
                    <option value="today" th:selected="${selectedTime == 'today'}">Today</option>
                </select>

                <label for="status">Status:</label>
                <select name="status" id="status" onchange="this.form.submit()">
                    <option value="all" th:selected="${selectedStatus == null or selectedStatus == 'all'}">All</option>
                    <option value="Delivered" th:selected="${selectedStatus == 'Delivered'}">Delivered</option>
                    <option value="Pending" th:selected="${selectedStatus == 'Pending'}">Pending</option>
                    <option value="shipped" th:selected="${selectedStatus == 'shipped'}">Shipped</option>
                    <option value="Cancelled" th:selected="${selectedStatus == 'Cancelled'}">Cancelled</option>
                </select>
            </form>
        </div>

        <h3 class="text-center mb-4">üìä Revenue Overview</h3>
        <canvas id="revenueChart" height="100"></canvas>
    </div>
</div>

<!--  Chart rendering -->
<script th:inline="javascript">
    const labels = [
        /*[# th:each="row : ${revenueData}"]*/
        /*[[${'"' + row[0] + '"'}]]*/,
        /*[/]*/
    ];

    const data = [
        /*[# th:each="row : ${revenueData}"]*/
        /*[[${row[1]}]]*/,
        /*[/]*/
    ];

    const ctx = document.getElementById('revenueChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Revenue (‚Ç™)',
                data: data,
                backgroundColor: '#0d6efd'
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: value => value + ' ‚Ç™'
                    }
                }
            }
        }
    });
</script>

</body>
</html>
